---
title: "Risk Assessment Overview"
author: "Open Source"
date: "26/05/2020"
output: 
  html_document:
  output: 
    html_document:
      number_sections: true
      toc: true
      toc_depth: 3
      toc_float: 
          collapse: false
          smooth_scroll: true
      code_download: true
      df_print: "paged" 
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

if (!require("ggplot2")) {
  install.packages("ggplot2")
  library(ggplot2)
}
if (!require("knitr")) {
  install.packages("knitr")
  library(knitr)
}
if (!require("lubridate")) {
  install.packages("lubridate")
}
if (!require("ShinyTester")) {
  install.packages("ShinyTester")
}
```
# __The Project Challenges__

### Project Background

We are looking to initiate this project to achive the following:

 + Transform cyber risk and threat assessment within our industry
 + Industry leader in the space, promoting industry excellence and behaviours
 + Develop open toolsets and frameworks for next generation cyber risk assessment
 + Open toolsets Community-developed OpenSource framework
 + Existing cyber risk and threat assessment is no longer fit for purpose â€“ an industry-wide challenge
    + Technology advancement
    + Risk complexity
    + Professionals (humans) cannot keep up with the complexity
    + Low ability to connect risk assessment with useful data/analysis/simulation
    + Low ability for clients to grow risk capability incrementally
    + linkage with business risk!
 
As-Is current processes: 

+ Manual
+ Qualitative
+ Hard to reuse/refine current documentation and toolsets

To-Be futue processes:

+ Semi-Automated
+ Quantitive
+ Predictive Analyitcs
  + Data Flow diagrams or equivelent
  + Vulerability/Threat Profiles and supporting automated feeds (CVSS, OSINT, Pen Testing)
  + Risk Estimation and simulation
+ Resusable documentation and toolsets

***

### Project Objectives

+ Structured Analsysis of existing data source and frameworks for usability in data-driven cyber risk assessment
+ Visualisation of Cyber Risks from interconnected systems. (System of Systems)
+ Prototyping of one or more analytical methods based on the data inputs and visual model in 1 and 2.
+ Open Framework, publically available, leveraged by extending exsiting ISO 27K framework approach through enhanced enterprise ready solutions.
+ Create a collabotative appraoch using agile open technology development initiatives.
+ Are the chosen data inputs, visual models and analystical techniques feasable?
+ Ability to use in an on-line and off-line mode.

***

### Goals

The goal is to start with a defined Asset Register.

+ Defined a set of Known Vulnerabilities for the assets
+ Defined a set of Potential vulnerabilities for the assets
+ Defined a set of threat actors
+ Defined an Impact Assessment for the asset register

Create a model that can dynamically assess the information security risks based on changing 

+ Threat Actors characteristics
+ Vulenrability Characteristics
+ Confidentiality, Intergrity and Availability characteristics

How does the risk profile change if the threat actor charactoristics change?

How does the risk profile change if the vulnerbaility characteristics change?

How does the risk profile change if the impact assessment changes?

How does the risk profile change if additional security controls are implmented?

How will the changes to the information risk profile be presented visually?

What are the best modelling techniques to use to assess the change in information secuirty risk profile? 

+ Develop an effective approach to modelling the risk of a system using these concepts.

  * Greater accuracy
  * Greater consistency
  * Repeatability
  * Speed of analysis
  
[Priority] Develop a prototype software tool that is usable online or offline to enable this modelling 

  + It must be usable by online or offline to carry out a risk assessment
  + It must articulate the risk of compromise to the system based on risk scenarios
  + It must automate the creation of a risk register
  + It must automate the creation of a risk treatment plan
  + It must use an acceptable analytics approach based statistical/data analysis techniques
  + It should be easy to update the model/dataset/input feeds
  
[Priority] Viaualisation Representation

+ Describe the known or potential vulnerability status 
+ Describe the importance of the data/info on the system
+ What is the best way to describe or represent information security risk within the system? 
+ What is the best way to model the behaviour of a threat actor? (threat modelling)
+ Display the nature of the connection between assets/nodes
+ Articulate the relationship between the assets (i.e. threat modelling?)
  
+ Group or arrange the assets in a table format and visual format that best descibes how they interact with each other?
  
	+ Does Asset A directly communciate with Asset B or vice versa
	+ Does Asset A use a service of Asset B 
  + Explain the nature of the connection between assets/nodes - 
    + what are the possibilities? 
	    + High level vs Fine grained detial
  + Define the asset/group taxonomy?
  + Identify and define all the potential asset types and categories out there that could come up in a risk assessemnt? 

__Additional future Requirements__

+ Assess the risk of an attack for particular scenarios? (e.g. web-based attack, phishing attack, networking)
+ Identify the technical security gaps, aligning them with controls defined in key security standards  
+ Develope an analytical engine that produces the risks and risk treatment plan 
+ add a threat actor or event to the nodes
+ identify linking data sources that extend the model 

***

### Identifying Potential Input Collateral
System types categories:

Asset categories/hierarchy 

	- define the asset taxonomy

Threat modelling frameworks + approaches? 
What are they?

	- e.g. OWASP/SEI/ATT&CK Mitre
	- e.g. HARM Taxonomy(https://www.researchgate.net/publication/315459761_Cyber_Harm_Concepts_Taxonomy_and_Measurement)

Asset relationships (i.e. edges)

	- asset A communicates with asset B
	- asset A uses browser to communicate with Asset B web server

Vulnerability descriptions 

	- e.g. process vulnerability
	- e.g. misconfiguration
	- e.g. software flaw 

Use standards as an input Risk taxonomy

	-ISO 93 - risk management definition. 

Explanation/examples of risk (probability + impact + vulnerability etc)

Show them an existing risk assessment approach?

+ Risk taxonomy of harm
+ Risk treatment taxonomy 

Potential analytical approaches e.g. 

	- Bayesian
	- Frequentist 

Vignette - example of org with associated risks
	(here is one way it could look like)
	

***

### Potential next Technical steps

1. Creation of a starter data set
	- "node + edge" CVS file
	- "threat" CVS file 
	- "vulnerability CVS file
	- "asset impact"
2. Define vignette (a generic model for consideration)
3. Define an attack scenario
4. Define supporting documentation - standards, taxonomies, overview of statistical techniques 
5. Define goal/challenges 
	- split across teams?  

***

# __Risks__
Risk assessments are used to support the risk management methodology. Risk Management provides an approach to understand the business requirements and determine the Opportunity versus the Threat to idnentify the security risks appropriately.

## Risks: Threats and Opportunities.
Risks can be either positive or a negative. Every business or organisation is looking to exploit an opportunity in order to achieve a business strategy and objective. 

Every time a business seeks to exploit an opportunity, this creates an equal and opposite opportunity for a threat actor to exploit a security weakness of the business. i.e. The application of implementing the opportunity increases the potentail attack surface.

## Risk Mitigation
As a consequence of identyfying the security risks the following are approaches that can be used to mitigate the attack surface.

1. Constrain the risk to an agreed level
1. Actively accept the risk to provide an opportuinty to gain a business benefit or advantage
1. Transfer the risk
1. Terminiate the activity that gives rise to the risk

Once it has been decided which risk mitigation is the correct treatment approach for the specific risk or group of risks, the next step is to then assess how effective that mitigation technic is to reducting the intial risk.

## Inherent and Residual Risk

There are two catagories of risk:

1. Inherent
1. Residual

### Inherent
The inherent risk is the output of an risk assessment without factoring any specific techincal security mitigation. If the organisation has implemented a baseline set of security hygeine, then the Inherent risk can take that into account.  But it will not include mitigations that are specifically targated to reduce the initial inherent risk.

### Residual

The residual risk is the output of the risk assessment after specific techncial security controls have been applied spefically to mitigate that risk. The residual risk is the exposure of the system in respect of the indentified risk which is both acceptable and justifiable.  

The residual risk should be within the risk appetite of associated tolerance for that asset or gorup of assets. 

# __Risk Appettite__

Risk appetite in any organisation can be defined in general terms as the variability in risks that the organisation and its senior execuatives are preapared to accept in support of a stated strategy.

The output of the risk needst o clearly articulate teh key levels of security that is accpetale in a form that is reasily comprehensible to non-specialists.

A risk appetite framework needs to define the approach to indentify the levels of risk that that are acceptable and incorporated into the risk management enterprise. It also reauires the need to identify and capture all the key stakeholder perspectives.

The outcome of the risk appetite framework is a risk appetite statement that addresses an agreed set of information asset groups or systems or business catagories. Once the appetite for the groups has been identified then the appropriate security controls can be identified and applied.

The risk appetite is an evolving state. It is influenced by a number of factors:

1. time since last breach
1. significance of that breach
1. changes in statutory requirements
1. connections to other environments
1. securit and training awareness
1. reputational characteristics
1. buisness objectives

Evidence suggests that the biggest infuencer in a sudden change of risk appetite stance would probably be the detection of a major breach which impacts on the reputation and cost involved in managing the aftermath of the breach.

The risk appetite will be a funciton of how much residual risk can be accepted after mitigation that has been applied to specific area of Buisness, Divsional Units, secific information asset groups, branches, sub branches, units, programmes or projects.

Risk appetites can be defined allowing different risk appetites to be applied to teh varous different units.

## Risk Tolerance

The risk tolerance considers how much the asset owner is prepared to manage a security control in relation to the risk appetite stance to achieved a desired objective for paticular programme or project or business function.

In essence it si teh amount of variation from teh risk appetite which the organisaiton will accept for a paticular business context.

If the risk tolerance is actually lower than the risk appetite, then cosnideration should be given to splitting the asset group as there is probably a desire to have a lower risk appetite for a sub-set fo that paticualer asset group.

## Risk Limit

The security risk limite is a statment that of how much residual risk the varous management layers are permitted to accept on behalf of the organisation.

It should be notes that the acceptance of risk not without potential harm, as if the vulnerability or weakness is compromised the subsequent cost of trying to repair the harm coudl be extemely high and outweigh any benefit from initially accepting the risk.

### Risk Appetite Review

The risk appetite adn assocaited tolerances shoudl be reviewed at least annually.  The appetite should refelct the latest thoughts around the protection of the asset which will be guided by awareness of events that have previously happened.

The must be reviewed after any event or incident that has occurred that may impact the asset or is the asstt group/catagories change in any way.

# __The Risk Appetite Framework__

The first step is to identify the scope of the information assets that are to be assessed.

The risk appetite can be applied to sub-departments, sub-organisations, sub-business fucntional areas where there are different business requirements, functions, working practices that are trying to achieve different strategies and opportunities.

It is advised to split the risk appetite into functional groups.

The next step is to identify the Asset Owners associated with the functional unit.

A risk appetite will then be identified for that functional group.

Each associated information asset component will need to be analysed.

The asset coudl be catagorised as an individual item, a collection of items or an entire organisation.

## The Risk Appetite Questionnaire
The Asset Owner must go through and answer the questionnaire.

The questionnaire consistes of a set of questions that have been aimed at covering the lifecycle of the programme/project/organisation from development through to transition to business as usual.

The aim of the questionniare is to understand the perception of risk that that the Asset Owner is prepared to accept for that asset/system.

The questionniare ranges in topics to gain an understanding of the Asset Owner perception of the importance from having a control to implement a security regime through to the perception of needing to have the information available to share.

The various questions are catagorised into two types of risk concern: 

1. A business type security concern
1. Techincal type of security concern

_Business Security concern_: is a risk catagory that is usually mitigate by using busines style management tools, processes or procedures.

_Technical security concern_: is a risk catagory that can be mitigated by implememnting a technical style system control.

The output of the technical control will be very high level and solution agnostic.

Each question has a choice of five responses that the asset owner can choose. The revolve around the change in perception of importance.  Statement C is the reference point which either has statmetns that are either less important or more important.

* A It is really not essential that ...
* B It is not essential that ...
* C It is neither not essential or essential that ...
* D It is essential that ...
* E It is really essential that ...

The Asset Owner will indicate their response to the question. They are not definitive repsonses, but inicate teh perception of importance in resposne to the question.  There is no right or wrong response.

__Example Question __
<p>
How inportant is the Business As Usual Security regime of the \<information asset\>.

1. The data-to-day security of the \<information asset\> is really not essential.
1. The data-to-day security of the \<information asset\> is not essential
1. The data-to-day security of the \<information asset\> is neither not essential or essential.
1. The data-to-day security of the \<information asset\> is essential.
1. The data-to-day security of the \<information asset\> is really essential.
<br>
<br>

```{r Example Question_slider, cache=FALSE,echo=FALSE}
renderText("If the Owner is happy to select just one of the answers, then move both sliders to the same location.")
HTML("<br>")
##### Specific Response #####
sliderInput(
  inputId = 'Question_Example_Specific_Response', label = 'Specific Response',
  min=1, max=5, value = c(3,3)
)



#### Analysing the input
Specific_example_rangeR <- reactive({input$Question_Example_Specific_Response[2]}) 
Specific_example_rangeL <- reactive({input$Question_Example_Specific_Response[1]})

Specific_example_range_hedge <-  reactive({
  input$Question_Example_Specific_Response[2] - input$Question_Example_Specific_Response[1]
  })

Specific_example_value <- reactive({
  if (Specific_example_range_hedge() == 0) {
 
   HTML(paste("You have chosen value ", Specific_example_rangeR(), " with certainty."))
 
} else if (Specific_example_range_hedge() == 1) {
  
   HTML(paste("You have chosen value ", Specific_example_rangeR(), " with ", Specific_example_range_hedge(), "degree of uncertainty."))

} else {
 
   HTML(paste("You have chosen value ", Specific_example_rangeR(), " with ", Specific_example_range_hedge(), "degrees of uncertainty."))
 
}
})
renderText(Specific_example_value())
```
<br>
<br>
```{r Narrow_Example_Question_slider, cache=FALSE,echo=FALSE}
renderText("If the Asset Owner is not sure if the answer lies with one specific answers, then move the sliders to the two adjacent location.")
HTML("<br>")
##### Narrow response #####
sliderInput(
  inputId = 'Question_Example_Narrow_Response', label = 'Narrow Response',
  min=1, max=5, value = c(4,5)
)



#### Analysing the input
Narrow_example_rangeR <- reactive({input$Question_Example_Narrow_Response[2]}) 
Narrow_example_rangeL <- reactive({input$Question_Example_Narrow_Response[1]})
  

Narrow_example_range_hedge <-  reactive({
  input$Question_Example_Narrow_Response[2] - input$Question_Example_Narrow_Response[1]
  })

Narrow_example_value <- reactive({
  if (Narrow_example_range_hedge() == 0) {
 HTML(paste("You have chosen value ", Narrow_example_rangeR(), " with full confidence."))
} else if (Narrow_example_range_hedge() == 1) {
 HTML(paste("You have chosen value ", Narrow_example_rangeR(), " with ", Narrow_example_range_hedge(), "degree of confidence."))
} else {
 HTML(paste("You have chosen value ", Narrow_example_rangeR(), " with ", Narrow_example_range_hedge(), "degrees of confidence."))
}
})
renderText(Narrow_example_value())
```
<br>
<br>
```{r Broad_Example_Question_slider, cache=FALSE,echo=FALSE}
renderText("If the Asset Owner is not sure if the answer lies with one specific answer or even adjecent answers, then move the sliders to cover the range.")
HTML("<br>")
##### Broad Response #####
sliderInput(
  inputId = 'Question_Example_Broad_Response', label = 'Broad Response',
  min=1, max=5, value = c(3,5)
)
Broad_example_range2 <- renderText({ input$Question_Example_Broad_Response })



#### Analysing the input
Broad_example_rangeR <- reactive({input$Question_Example_Broad_Response[2]}) 
Broad_example_rangeL <- reactive({input$Question_Example_Broad_Response[1]})
  

Broad_example_range_hedge <-  reactive({
  input$Question_Example_Broad_Response[2] - input$Question_Example_Broad_Response[1]
  })

Broad_example_value <- reactive({
  if (Broad_example_range_hedge() == 0) {
 HTML(paste("You have chosen value ", Broad_example_rangeR(), " with certainty."))
} else if (Broad_example_range_hedge() == 1) {
 HTML(paste("You have chosen value ", Broad_example_rangeR(), " with ", Broad_example_range_hedge(), "degree of confidence."))
} else {
 HTML(paste("You have chosen value ", Broad_example_rangeR(), " with ", Broad_example_range_hedge(), "degrees of confidence."))
}
})
renderText(Broad_example_value())
```
</p>
<br>
### Cyber Risk Appetite Assessment
Overview: A key aspect of understanding the risk appetite of an organisation is its willingness to accepts a risk, when taking into account the 
<br>
<p>
__Question 1: Governance__ 
_Clarification_: This question seeks to understand the importance of having a control in place to protect the information asset.

How important is the Business As Usual Security regime of the \<information asset\>.

1. The data-to-day security of the \<information asset\> is really not essential.
1. The data-to-day security of the \<information asset\> is not essential
1. The data-to-day security of the \<information asset\> is neither not essential or essential.
1. The data-to-day security of the \<information asset\> is essential.
1. The data-to-day security of the \<information asset\> is really essential.
<br>
<br>
```{r Question_1_slider, cache=FALSE,echo=FALSE}
HTML("<br>")
sliderInput(
  inputId = 'Question_1_Response', label = 'Question 1 Response',
  min=1, max=5, value = c(3,3)
)
Q1 <- renderText({ input$Question_1_Response })



#### Analysing the input
Q1R <- reactive({input$Question_1_Response[2]}) 
Q1L <- reactive({input$Question_1_Response[1]})
  

Q1_range_hedge <-  reactive({
  input$Question_1_Response[2] - input$Question_1_Response[1]
  })

Q1_value <- reactive({
  if (Q1_range_hedge() == 0) {
 HTML(paste("You have chosen value ", Q1R(), " with certainty."))
} else if (Q1_range_hedge() == 1) {
 HTML(paste("You have chosen value ", Q1R(), " with ", Q1_range_hedge(), "degree of confidence."))
} else {
 HTML(paste("You have chosen value ", Q1R(), " with ", Q1_range_hedge(), "degrees of confidence."))
}
})
renderText(Q1_value())
```
</p>

### Loading Risk Appetite Questions
Overview: This will display the questions that need to be answered. 
<br>
<p>

```{r load_risk_appetite, echo=FALSE}
library(dplyr, warn.conflicts = FALSE)
# Load risk appetite data data from CSV
riskappetite <- data.frame(read.csv("Risk_Appetite_Questions.csv", header = TRUE))
head(riskappetite)
i <- nrow(riskappetite)
head(i)
selectInput(
  inputId = 'InputQuestion', label = 'Select the question to answer', choices = c(1:i)
  )

question <- reactive ({
  q <- subset(riskappetite, Number == input$InputQuestion)
  
  return(q[1])
})

renderTable(question())


```


# __Threats__

# __Vulnerabilities__

# __Impact Assessment __

# __Asset List__
```{r Load_Asset_Data, echo=FALSE}
require(visNetwork)
# Load nodes data from CSV
nodeData <- read.csv("~/black_swan/risk_network/ORG-NODES.csv", header = TRUE)
nodes <- as.data.frame(nodeData)

# Load edges from CSV
edgeData <- read.csv("~/black_swan/risk_network/ORG-EDGES.csv", header = TRUE)
edges <- as.data.frame(edgeData)

network <- reactive({
  nodes %>% select(label, group, group.label)
})

AssetList = renderTable({
    network()
})
AssetList
```


# __Risk Assessment__

```{r risk_assessment_network, echo=FALSE}

require(visNetwork)

network_proxy_nodes <- renderVisNetwork({
visNetwork(nodes, edges) %>% visPhysics(stabilization = TRUE) %>% visOptions(highlightNearest = TRUE) %>%  visOptions(nodesIdSelection = TRUE) %>% visLegend() %>% visOptions(manipulation = TRUE)
                        })
network_proxy_nodes
```


# __Risk Treatment Plan__

# __Risk Appetite Questions__
__Question 1: Security Hygiene__ 
_Clarification_: This question seeks to understnad the importance of having a control in place to protect the information asset.

How inportant is the Business As Usual Security regime of the \<information asset\>.

1. The data-to-day security of the \<information asset\> is really not essential.
1. The data-to-day security of the \<information asset\> is not essential
1. The data-to-day security of the \<information asset\> is neither not essential or essential.
1. The data-to-day security of the \<information asset\> is essential.
1. The data-to-day security of the \<information asset\> is really essential.
<br>
<br>
```{r Question 1 slider, cache=FALSE,echo=FALSE}
HTML("<br>")
sliderInput(
  inputId = 'Question_1_Response', label = 'Question 1 Response',
  min=1, max=5, value = c(3,3)
)
Q1 <- renderText({ input$Question_1_Response })



#### Analysing the input
Q1R <- reactive({input$Question_1_Response[2]}) 
Q1L <- reactive({input$Question_1_Response[1]})
  

Q1_range_hedge <-  reactive({
  input$Question_1_Response[2] - input$Question_1_Response[1]
  })


Q1_value <- reactive({
  if (Q1_range_hedge() == 0) {
 HTML(paste("You have chosen value ", Q1R(), " with certainty."))
} else if (Q1_range_hedge() == 1) {
 HTML(paste("You have chosen value ", Q1R(), " with ", Q1_range_hedge(), "degree of confidence."))
} else {
 HTML(paste("You have chosen value ", Q1R(), " with ", Q1_range_hedge(), "degrees of confidence."))
}
})

renderText(Q1_value())
```
</p>